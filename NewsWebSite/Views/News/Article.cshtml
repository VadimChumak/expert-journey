@using NewsWebSite.Models.ViewModel;
@model ArticleForView
@{
    Layout = "~/Views/Shared/Lay.cshtml";
}
<article id="articledata" data-userid="@Model.UserId" data-maxlen="@ViewBag.MaxCommentLength" data-articleid="@Model.Id">
    <div class="row">
        <div class="col s12 m12 l12">
            <div class="card z-depth-1">
                <div class="card-image">
                    @if (Model.Image != "Empty")
                    {
                        <img src="@Url.Content("~/Content/ArticlImages/" + Model.Id + "/" + Model.Image)" alt="SRC">
                    }
                    @if (Model.Editable)
                    {
                        <a href="@Url.Action("EditArticle", new { Id = Model.Id })" class="btn" style="margin-top:15px;margin-left:15px"><i class="material-icons">edit</i></a>
                        <a href="@Url.Action("Delete", new { Id = Model.Id })" class="btn" style="margin-top:15px;margin-left:15px"><i class="material-icons">delete</i></a>
                    }
                </div>
                <div class="card-content">
                    <span class="card-title">@Model.Title</span>
                    <br />
                    <div class="divider"></div>
                    <br />
                    <p>@Html.Raw(Model.FullDescription)</p><br />
                    <div class="divider"></div><br />
                    @TagListHelper.DisabledModelTagsList(Model.ArticleTags)
                    <div class="divider"></div><br />
                    @if (Model.UpdateDate != null)
                    {
                        <p>@Model.UpdateDate</p>
                    }
                    else
                    {
                        <p>@Model.CreateDate</p>
                    }
                </div>
            </div>
        </div>
    </div>
</article>

<div class="commentsBlock">
    <div id="comments" class="comments white z-depth-1" style="padding:20px;">
        <div id="loaderBlock">
            <div id="loader" class="hidden"></div>
        </div>
    </div>
    @if (User.Identity.IsAuthenticated)
    {
        <div class="sendBlock hidden white z-depth-1" id="sendBlock" style="margin:20px 0; padding:20px">
            <textarea name="message" id="message"></textarea>
            <input type="button" class="waves-effect waves-light btn" value="Send" id="send" />
        </div>
    }
</div>

@section scripts {
    @Scripts.Render("~/bundles/articlePage")
    <script type="text/template" id="template">
        <div class="comment" id="comment-[Id]" userid="[uId]" style="padding-left: 8px; border-left: 1px solid #D3D3D3">
            <div class="contentComment">
                <h5 class="commentName blue-text" id="commentName-[Id]">[Name]</h5>
                <p class="commentDate blue-grey-text" id="commentDate-[Id]" style="margin-bottom:10px;">[Date]</p>
                <p class="commentText commentContent" id="text-[Id]">[Text]</p>
                <p class="commentText editor hidden grey lighten-2" id="edit-[Id]" contenteditable="true"></p>
            </div>
            @if (Model.UserId > 0)
            {
                <div id="buttons-[Id]" class="">
                    <input type="button" value="Reply" class="showSendBlock commentsBtn waves-effect waves-light btn-flat blue-text" id="[Id]" />
                    <input type="button" value="Edit" class="commentsBtn waves-effect waves-light btn-flat blue-text [Class] editButton" id="editBtn-[Id]" />
                    <input type="button" value="Save" class="commentsBtn waves-effect waves-light btn-flat blue-text saveButton hidden" id="SaveBtn-[Id]" />
                    <input type="button" value="Delete" class="commentsBtn waves-effect waves-light btn-flat [Class] blue-text deleteButton" id="deleteBtn-[Id]" />
                    <div class="sendBlock hidden" id="sendBlock-[Id]">
                        <textarea name="message" id="message-[Id]"></textarea>
                        <input type="button" class="replyBtn commentsBtn waves-effect waves-light btn" value="Send" id="send-[Id]" />
                    </div>
                </div>
            }
            <div class="divider" style="margin:10px 0"></div>
        </div>
    </script>

    <script>
        $('select').select2({
            tags: true
        });
    </script>
}
